<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>겜블링 게임 (Open Challenge 8)</title>
    <style>
        /* 4장. CSS3 스타일 시트 - 박스 모델 및 기본 스타일링 */
        #gameboard {
            border: 5px solid darkred;
            /* 4장. border-width, border-style, border-color */
            width: 310px;
            text-align: center;
        }

        div {
          background-color: mistyrose;
            /* 4장. background-color */
        }

        span {
            /* 4장. 박스 모델 - width/height, padding, font-size */
            display: inline-block;
            /* 5장. inline-block으로 설정하여 크기 조절 및 옆 배치 허용 */
            border: 1px solid violet;
            width: 80px;
            height: 80px;
            color: blue;
            font-size: 60px;
            text-align: center;
            line-height: 80px;
            /* 세로 중앙 정렬 */
            cursor: pointer;
            /* 4장. cursor 프로퍼티 */

            /* 5장. CSS3 고급 활용 - 전환 (Transition) 추가 */
            transition: background-color 0.3s, transform 0.2s;
            /* 배경색과 변환에 0.3초/0.2초 전환 효과 적용 */
        }

        /* 4장. 가상 클래스 셀렉터 :hover 적용 */
        span:hover {
            background-color: lightskyblue;
            transform: scale(1.05);
            /* 5장. 변환 (Transform): 마우스 오버 시 살짝 확대 */
        }

        p {
            color: plum;
            font-weight: bold;
        }
    </style>
</head>

<body id="parent">
    <h3>겜블링 게임</h3>
    각 숫자를 클릭하면 0에서 2사이의 난수로 바뀝니다. 모두 같은 수가 나오면 승리합니다.
    <hr>

    <div id="gameboard">
        <span id="0" onclick="change(this)">0</span>
        <span id="1" onclick="change(this)">0</span>
        <span id="2" onclick="change(this)">0</span>
    </div>

    <script>
        // 7장. Array 객체를 이용한 배열 선언 및 6장. var 키워드를 이용한 변수 선언
        var flagArr = [0, 0, 0]; // 0: 클릭 가능, 1: 클릭됨. (원래 1, 1, 1을 0, 0, 0으로 변경하여 0이 '클릭되지 않음'을 나타내도록 개선)

        // 6장. 함수 작성
        function change(obj) {
            // 6장. 식별자: this 키워드로 전달받은 객체 (span) 사용
            var objId = parseInt(obj.id); // 6장. parseInt() 전역 함수 사용

            // 6장. 조건문 (if) 및 6장. 논리 연산자 (&&)
            if (flagArr[objId] == 0) {
                flagArr[objId] = 1;

                // 7장. Math 객체: Math.floor(Math.random() * 3)으로 0, 1, 2 중 난수 생성
                // obj.프로퍼티 = 값; = 객체 접근
                obj.innerHTML = Math.floor(Math.random() * 3); // 8장. DOM 객체의 innerHTML 변경
            }

            // 6장. 논리 연산자 (&&)를 사용하여 모든 요소가 클릭되었는지 판별 (기존 코드에서 & -> &&로 수정)
            if (flagArr[0] == 1 && flagArr[1] == 1 && flagArr[2] == 1) {
                result();
            }
        }

        function result() {
            // 8장. document 객체의 getElementsByTagName()으로 span 요소 컬렉션 접근
            var spanArr = document.getElementsByTagName("span");

            // 6장. 조건문 및 논리 연산자 (&&)를 사용하여 승패 판정
            // span의 innerHTML은 문자열이므로, 문자열 비교 수행
            if (spanArr[0].innerHTML == spanArr[1].innerHTML && spanArr[1].innerHTML == spanArr[2].innerHTML) {
                text = "Success! (click here to play again)";
            } else {
                text = "Fail! (click here to play again)";
            }

            // 8장. DOM 객체 동적 생성 및 삽입
            var obj = document.getElementById("parent"); // 8장. 부모 요소 (body) 획득
            var newP = document.createElement("p"); // 8장. createElement()로 새로운 <p> 태그 생성
            newP.innerHTML = text; // 8장. innerHTML로 콘텐츠 설정
            newP.style.color = "darkred"; // 8장. DOM 객체의 CSS 스타일 동적 변경

            // 게임 재시작 기능 구현
            newP.addEventListener("click",
                function () {
                    // 브라우저 객체 모델 (BOM, 8장 간접 언급)의 location 객체를 이용한 페이지 새로고침
                    location.reload();
                })

            obj.appendChild(newP); // 8장. appendChild()로 DOM 트리에 추가
        }
    </script>
</body>

</html>